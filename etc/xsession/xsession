#!/bin/sh
## xsession for xsession in /home/ctaf/.ctafconf/etc/xsession
##
## Made by GESTES Cedric
## Login   <ctaf@epita.fr>
##
## Started on  Mon Sep 26 02:37:56 2005 GESTES Cedric
## Last update Mon Mar 27 03:40:41 2006 GESTES Cedric
##
##CTAFCONF

#refuse all connection to xserver except for localhost
xhost -
xhost +localhost

#merge setting for x application (xterm,aterm,..)
xrdb -merge ~/.ctafconf/etc/Xdefaults

if [ -f ~/.ctafconf/perso/user-profile ] ; then
    . ~/.ctafconf/perso/user-profile
fi


if [ x$ctafconf_wm != xgnome ] ; then
#set the wallpaper
~/.ctafconf/bin/ct-set-bg
fi

#personal startup file
if [ -f ~/.ctafconf/perso/startup ]; then
    ~/.ctafconf/perso/startup
fi

#xbindkeys
if which xbindkeys >/dev/null 2>/dev/null; then
  xbindkeys&
fi

#gaim
if which gaim >/dev/null 2>/dev/null; then
  gaim&
fi

if [ -f ~/.ctafconf/perso/xsession.mine ]; then
    source ~/.ctafconf/perso/xsession.mine
fi

########################### LAUNCHING WM ###########################
#Lauch gnome (appel bloquant)
if [ x$ctafconf_wm = xgnome ]; then
    exec gnome-session
fi

#launch the gnome setting daemon (for font, gconf, ...) after gnome-session
#cause gnome-session launch it
if which gnome-settings-daemon >/dev/null 2>/dev/null; then
  gnome-settings-daemon&
fi

#lauch kde
if [ x$ctafconf_wm = xkde ]; then
  if which startkde >/dev/null 2>/dev/null; then
    exec startkde
  fi
fi

#lauch xfce4
if [ x$ctafconf_wm = xxfce4 ]; then
  if which startxfce4 >/dev/null 2>/dev/null; then
    exec startxfce4
  fi
fi


#fluxbox
if [ x$ctafconf_wm = xfluxbox ]; then
  #eterm
  if which Eterm >/dev/null 2>/dev/null; then
    Eterm -x 0 --trans --buttonbar 0 --scrollbar=off -O --shade 75 -g 84x20+0+15&
    Eterm -x 0 --trans --buttonbar 0 --scrollbar=off -O --shade 75 -g 84x20+512+15&
  fi

  #torsmo
  if which torsmo >/dev/null 2>/dev/null; then
    torsmo -b&
  fi

  exec startfluxbox
fi

#anothers wm
if which $ctafconf_wm >/dev/null 2>/dev/null ; then
    exec $ctafconf_wm
fi

exec xterm

#if [ -f ~/.ctafconf/etc/xsession/xsession.$ctafconf_config ]; then
#  . ~/.ctafconf/etc/xsession/xsession.$ctafconf_config
#fi
